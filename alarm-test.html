<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•ŒëŒ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .test-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            background: rgba(0, 0, 0, 0.2);
        }
        .success { background: rgba(46, 204, 113, 0.3); }
        .error { background: rgba(231, 76, 60, 0.3); }
        .warning { background: rgba(241, 196, 15, 0.3); }
        .info { background: rgba(52, 152, 219, 0.3); }
    </style>
</head>
<body>
    <h1>ğŸ”” ì•ŒëŒ ê¸°ëŠ¥ ì§„ë‹¨ ë„êµ¬</h1>
    
    <div class="test-section">
        <h2>1. ë¸Œë¼ìš°ì € ì§€ì› í™•ì¸</h2>
        <div id="browserSupport"></div>
    </div>
    
    <div class="test-section">
        <h2>2. ì•Œë¦¼ ê¶Œí•œ ìƒíƒœ</h2>
        <div id="permissionStatus"></div>
        <button onclick="requestPermission()">ì•Œë¦¼ ê¶Œí•œ ìš”ì²­</button>
    </div>
    
    <div class="test-section">
        <h2>3. ì¦‰ì‹œ ì•Œë¦¼ í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testImmediateNotification()">ì¦‰ì‹œ ì•Œë¦¼ í…ŒìŠ¤íŠ¸</button>
        <div id="immediateTestResult"></div>
    </div>
    
    <div class="test-section">
        <h2>4. ì§€ì—° ì•Œë¦¼ í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testDelayedNotification()">5ì´ˆ í›„ ì•Œë¦¼ í…ŒìŠ¤íŠ¸</button>
        <div id="delayedTestResult"></div>
    </div>
    
    <div class="test-section">
        <h2>5. í• ì¼ ì•ŒëŒ ì‹œë®¬ë ˆì´ì…˜</h2>
        <button onclick="testTodoAlarm()">í• ì¼ ì•ŒëŒ ì‹œë®¬ë ˆì´ì…˜</button>
        <div id="todoTestResult"></div>
    </div>
    
    <div class="test-section">
        <h2>6. ì½˜ì†” ë¡œê·¸</h2>
        <div id="consoleLog"></div>
        <button onclick="clearLog()">ë¡œê·¸ ì§€ìš°ê¸°</button>
    </div>

    <script>
        // ì½˜ì†” ë¡œê·¸ ìº¡ì²˜
        const originalLog = console.log;
        const originalError = console.error;
        const logContainer = document.getElementById('consoleLog');
        
        function addLog(message, type = 'info') {
            const logEntry = document.createElement('div');
            logEntry.className = `status ${type}`;
            logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addLog(args.join(' '), 'info');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addLog(args.join(' '), 'error');
        };
        
        function clearLog() {
            logContainer.innerHTML = '';
        }
        
        // ë¸Œë¼ìš°ì € ì§€ì› í™•ì¸
        function checkBrowserSupport() {
            const support = document.getElementById('browserSupport');
            let html = '';
            
            // Notification API ì§€ì›
            const notificationSupported = 'Notification' in window;
            html += `<div class="status ${notificationSupported ? 'success' : 'error'}">
                Notification API: ${notificationSupported ? 'ì§€ì›ë¨' : 'ì§€ì› ì•ˆë¨'}
            </div>`;
            
            // Service Worker ì§€ì›
            const swSupported = 'serviceWorker' in navigator;
            html += `<div class="status ${swSupported ? 'success' : 'error'}">
                Service Worker: ${swSupported ? 'ì§€ì›ë¨' : 'ì§€ì› ì•ˆë¨'}
            </div>`;
            
            // ë¸Œë¼ìš°ì € ì •ë³´
            html += `<div class="status info">
                User Agent: ${navigator.userAgent}
            </div>`;
            
            support.innerHTML = html;
        }
        
        // ê¶Œí•œ ìƒíƒœ í™•ì¸
        function checkPermissionStatus() {
            const status = document.getElementById('permissionStatus');
            const permission = Notification.permission;
            
            let statusClass = 'warning';
            let statusText = 'ì•Œ ìˆ˜ ì—†ìŒ';
            
            switch(permission) {
                case 'granted':
                    statusClass = 'success';
                    statusText = 'í—ˆìš©ë¨';
                    break;
                case 'denied':
                    statusClass = 'error';
                    statusText = 'ê±°ë¶€ë¨';
                    break;
                case 'default':
                    statusClass = 'warning';
                    statusText = 'ìš”ì²­ í•„ìš”';
                    break;
            }
            
            status.innerHTML = `<div class="status ${statusClass}">
                ì•Œë¦¼ ê¶Œí•œ: ${statusText}
            </div>`;
        }
        
        // ê¶Œí•œ ìš”ì²­
        async function requestPermission() {
            try {
                const permission = await Notification.requestPermission();
                console.log('ê¶Œí•œ ìš”ì²­ ê²°ê³¼:', permission);
                checkPermissionStatus();
                
                if (permission === 'granted') {
                    addLog('ì•Œë¦¼ ê¶Œí•œì´ í—ˆìš©ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                } else {
                    addLog('ì•Œë¦¼ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'error');
                }
            } catch (error) {
                console.error('ê¶Œí•œ ìš”ì²­ ì‹¤íŒ¨:', error);
                addLog('ê¶Œí•œ ìš”ì²­ ì‹¤íŒ¨: ' + error.message, 'error');
            }
        }
        
        // ì¦‰ì‹œ ì•Œë¦¼ í…ŒìŠ¤íŠ¸
        function testImmediateNotification() {
            const result = document.getElementById('immediateTestResult');
            
            if (Notification.permission !== 'granted') {
                result.innerHTML = '<div class="status error">ì•Œë¦¼ ê¶Œí•œì´ í—ˆìš©ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            try {
                const notification = new Notification('ğŸ”” ì¦‰ì‹œ ì•Œë¦¼ í…ŒìŠ¤íŠ¸', {
                    body: 'ì´ ì•Œë¦¼ì´ ë³´ì´ë©´ ì•Œë¦¼ ê¸°ëŠ¥ì´ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤!',
                    tag: 'immediate-test'
                });
                
                notification.onclick = function() {
                    console.log('ì¦‰ì‹œ ì•Œë¦¼ í´ë¦­ë¨');
                    notification.close();
                };
                
                setTimeout(() => {
                    notification.close();
                }, 5000);
                
                result.innerHTML = '<div class="status success">ì¦‰ì‹œ ì•Œë¦¼ì´ í‘œì‹œë˜ì—ˆìŠµë‹ˆë‹¤!</div>';
                console.log('ì¦‰ì‹œ ì•Œë¦¼ í…ŒìŠ¤íŠ¸ ì„±ê³µ');
                
            } catch (error) {
                result.innerHTML = '<div class="status error">ì¦‰ì‹œ ì•Œë¦¼ ìƒì„± ì‹¤íŒ¨: ' + error.message + '</div>';
                console.error('ì¦‰ì‹œ ì•Œë¦¼ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error);
            }
        }
        
        // ì§€ì—° ì•Œë¦¼ í…ŒìŠ¤íŠ¸
        function testDelayedNotification() {
            const result = document.getElementById('delayedTestResult');
            
            if (Notification.permission !== 'granted') {
                result.innerHTML = '<div class="status error">ì•Œë¦¼ ê¶Œí•œì´ í—ˆìš©ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            result.innerHTML = '<div class="status info">5ì´ˆ í›„ì— ì•Œë¦¼ì´ í‘œì‹œë©ë‹ˆë‹¤...</div>';
            console.log('ì§€ì—° ì•Œë¦¼ í…ŒìŠ¤íŠ¸ ì‹œì‘ - 5ì´ˆ í›„ ì•Œë¦¼ ì˜ˆì •');
            
            setTimeout(() => {
                try {
                    const notification = new Notification('â° ì§€ì—° ì•Œë¦¼ í…ŒìŠ¤íŠ¸', {
                        body: '5ì´ˆ í›„ì— ì•Œë¦¼ì´ í‘œì‹œë˜ì—ˆìŠµë‹ˆë‹¤!',
                        tag: 'delayed-test'
                    });
                    
                    notification.onclick = function() {
                        console.log('ì§€ì—° ì•Œë¦¼ í´ë¦­ë¨');
                        notification.close();
                    };
                    
                    setTimeout(() => {
                        notification.close();
                    }, 5000);
                    
                    result.innerHTML = '<div class="status success">ì§€ì—° ì•Œë¦¼ì´ ì„±ê³µì ìœ¼ë¡œ í‘œì‹œë˜ì—ˆìŠµë‹ˆë‹¤!</div>';
                    console.log('ì§€ì—° ì•Œë¦¼ í…ŒìŠ¤íŠ¸ ì„±ê³µ');
                    
                } catch (error) {
                    result.innerHTML = '<div class="status error">ì§€ì—° ì•Œë¦¼ ìƒì„± ì‹¤íŒ¨: ' + error.message + '</div>';
                    console.error('ì§€ì—° ì•Œë¦¼ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error);
                }
            }, 5000);
        }
        
        // í• ì¼ ì•ŒëŒ ì‹œë®¬ë ˆì´ì…˜
        function testTodoAlarm() {
            const result = document.getElementById('todoTestResult');
            
            if (Notification.permission !== 'granted') {
                result.innerHTML = '<div class="status error">ì•Œë¦¼ ê¶Œí•œì´ í—ˆìš©ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            // í˜„ì¬ ì‹œê°„ì—ì„œ 1ë¶„ í›„ë¡œ ì„¤ì •
            const now = new Date();
            const alarmTime = new Date(now.getTime() + 60000); // 1ë¶„ í›„
            
            const testTodo = {
                id: 'test-todo-' + Date.now(),
                text: 'í…ŒìŠ¤íŠ¸ í• ì¼',
                time: alarmTime.toTimeString().slice(0, 5),
                priority: 'high',
                completed: false,
                date: alarmTime.toISOString().slice(0, 10)
            };
            
            result.innerHTML = '<div class="status info">1ë¶„ í›„ì— í• ì¼ ì•ŒëŒì´ ìš¸ë¦½ë‹ˆë‹¤...</div>';
            console.log('í• ì¼ ì•ŒëŒ ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘:', testTodo);
            
            setTimeout(() => {
                try {
                    const notification = new Notification('â° í• ì¼ ì•Œë¦¼', {
                        body: `${testTodo.text}\nì‹œê°„: ${testTodo.time}\nìš°ì„ ìˆœìœ„: ${testTodo.priority}`,
                        tag: `todo-${testTodo.id}`,
                        requireInteraction: true
                    });
                    
                    notification.onclick = function() {
                        console.log('í• ì¼ ì•ŒëŒ í´ë¦­ë¨');
                        notification.close();
                    };
                    
                    setTimeout(() => {
                        notification.close();
                    }, 10000);
                    
                    result.innerHTML = '<div class="status success">í• ì¼ ì•ŒëŒì´ ì„±ê³µì ìœ¼ë¡œ í‘œì‹œë˜ì—ˆìŠµë‹ˆë‹¤!</div>';
                    console.log('í• ì¼ ì•ŒëŒ ì‹œë®¬ë ˆì´ì…˜ ì„±ê³µ');
                    
                } catch (error) {
                    result.innerHTML = '<div class="status error">í• ì¼ ì•ŒëŒ ìƒì„± ì‹¤íŒ¨: ' + error.message + '</div>';
                    console.error('í• ì¼ ì•ŒëŒ ì‹œë®¬ë ˆì´ì…˜ ì‹¤íŒ¨:', error);
                }
            }, 60000);
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', function() {
            console.log('ì•ŒëŒ ì§„ë‹¨ ë„êµ¬ ë¡œë“œë¨');
            checkBrowserSupport();
            checkPermissionStatus();
        });
    </script>
</body>
</html>
